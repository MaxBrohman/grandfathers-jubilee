!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return n});function i(e,t,r,i){return new(r||(r=Promise))(function(n,o){function a(e){try{c(i.next(e))}catch(e){o(e)}}function s(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new r(function(t){t(e.value)}).then(a,s)}c((i=i.apply(e,t||[])).next())})}function n(e,t){var r,i,n,o,a={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,i&&(n=2&o[0]?i.return:o[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,o[1])).done)return n;switch(i=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(n=(n=a.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){a.label=o[1];break}if(6===o[0]&&a.label<n[1]){a.label=n[1],n=o;break}if(n&&a.label<n[2]){a.label=n[2],a.ops.push(o);break}n[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],i=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}},function(e,t,r){"use strict";r.r(t);var i=r(0),n=function(){function e(){this.width=640,this.height=480,this.cameraUrl="./camera_para.dat",this.patternUrl="./pattern-marker.patt",this.video=document.createElement("video"),this.cameraParams=new ARCameraParam,this.videoParams={audio:!1,video:{width:{ideal:this.width},height:{ideal:this.height},facingMode:"environment"}},this.process=this.process.bind(this),this.playVideo=this.playVideo.bind(this)}return e.prototype.initCamera=function(){var e=this;return new Promise(function(t){e.cameraParams.onload=function(){e.controller=new ARController(e.width,e.height,e.cameraParams),e.initVideoSource().then(function(e){t(e)}).catch(function(e){console.error("error occured",e.message)})},e.cameraParams.load(e.cameraUrl)})},e.prototype.initMarker=function(e){var t=this;return new Promise(function(r){return i.a(t,void 0,void 0,function(){var t;return i.b(this,function(i){switch(i.label){case 0:return[4,this.setMarker(this.patternUrl,e)];case 1:return t=i.sent(),r(t),[2]}})})})},e.prototype.setMarker=function(e,t){var r=this;return new Promise(function(i){r.controller.loadMarker(e,function(e){var n=r.createMarkerRoot(e,t);i(n)})})},e.prototype.process=function(){return this.controller.process(this.video)},e.prototype.onWindowResize=function(e,t){e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight)},e.prototype.onVideoResize=function(){var e=window.innerWidth,t=window.innerHeight,r=this.video.videoWidth/this.video.videoHeight;if(e/t<r){var i=r*t;this.video.style.width=i+"px",this.video.style.marginLeft=-(i-e)/2+"px",this.video.style.height=t+"px",this.video.style.marginTop="0px"}else{var n=1/(r/e);this.video.style.height=n+"px",this.video.style.marginTop=-(n-t)/2+"px",this.video.style.width=e+"px",this.video.style.marginLeft="0px"}},e.prototype.getStream=function(){return navigator.mediaDevices.getUserMedia(this.videoParams)},e.prototype.initVideoSource=function(){var e=this;return new Promise(function(t){e.getStream().then(function(r){e.video.srcObject=r,e.setVideoStyles(),t(e.video)}).catch(function(e){console.warn("Camera access needed",e.message)})})},e.prototype.playVideo=function(){this.video.play(),document.body.removeEventListener("click",this.playVideo)},e.prototype.setVideoStyles=function(){var e=this;this.video.style.position="absolute",this.video.style.top="0px",this.video.style.left="0px",this.video.style.zIndex="-2",document.body.addEventListener("click",this.playVideo),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),this.video.addEventListener("loadedmetadata",function(){document.body.appendChild(e.video),e.onVideoResize()}),this.video.style.width="640px",this.video.style.height="480px"},e.prototype.createMarkerRoot=function(e,t){return this.controller.threePatternMarkers={},t.markerTracker=this.controller.trackPatternMarkerId(e),t.markerMatrix=new Float64Array(12),t.matrixAutoUpdate=!1,this.controller.threePatternMarkers[e]=t,t},e}();t.default=n}]);
//# sourceMappingURL=ar.bundle.js.map